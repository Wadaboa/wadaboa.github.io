<!DOCTYPE html>

<!--
  portfolYOU Jekyll theme by Youssef Raafat
  Free for personal and commercial use under the MIT license
  https://github.com/YoussefRaafatNasry/portfolYOU
-->

<html lang="en" class="h-100">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content=""I love keyboards :keyboard:,  open-source software :penguin: and  learning something new everyday :open_book:."">

  <title>Alessio Falai</title>
  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css" type="text/css"/>
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css" type="text/css">


    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-161544643-1', 'auto');
	ga('send', 'pageview', { 'page': location.pathname + location.search + location.hash});
	ga('set', 'anonymizeIp', false);
    </script>
    <!-- End Google Analytics -->
    </head>


<body class="d-flex flex-column h-100">

  <main class="flex-shrink-0 container mt-5">
  <nav class="navbar navbar-expand-lg navbar-light">

  <a class="navbar-brand" href="/"><h5><b>Alessio Falai</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto">
<a class="nav-item nav-link " href="/projects/">Projects</a>

      <a class="nav-item nav-link active" href="/blog/">Blog</a>

      <a class="nav-item nav-link " href="/about/">About</a>

      <a class="nav-item nav-link " href="/experience/">Experience</a>

      

    </div>
  </div>

</nav>
  <div class="col-lg-10 mx-auto mt-5 post">
  <h1><b>Jekyll + Github Pages + Travis CI</b></h1>

<p class="post-metadata text-muted">
  23 March 2020 -  
  <b>7 mins read time</b>

  <br>Tags: 
    
    <a class="text-decoration-none no-underline" href="/blog/tags#web">
      <span class="tag badge badge-pill text-primary border border-primary">Web</span>
    </a>
    </p>

<h3 id="introduction">Introduction</h3>

<p>Have you ever heard of static sites? Well, if your answer is no, stick with me and you will learn the basics of them.</p>

<p>As defined on <a href="https://en.wikipedia.org/wiki/Static_web_page">Wikipedia</a>, a flat page is a web page that is delivered to the user’s web browser exactly as stored, such that this page displays the same information for all users. Actually, <em>“exactly as stored”</em> would be too restrictive to produce a decent website with minimal effort, and here is where <strong>Jekyll</strong> comes into play.</p>

<h3 id="what-is-jekyll">What is Jekyll?</h3>

<p><a href="https://jekyllrb.com/">Jekyll</a> is a tool used to generate simple, blog-aware, static websites. Let’s analyze those words:</p>

<ul>
  <li>
<strong>Simple</strong>: The gist is that you don’t have to deal with databases</li>
  <li>
<strong>Blog-aware</strong>: Jekyll natively handles posts, categories, permalinks and more</li>
  <li>
<strong>Static</strong>: The only files you should have to deal with are HTML, CSS and Markdown</li>
</ul>

<p>Jekyll uses the so-called <a href="https://github.com/Shopify/liquid"><code class="highlighter-rouge">Liquid</code></a> template engine, developed by Shopify, which we can exploit to inject some logic into our static files. Liquid is based upon two types of markup:</p>

<ul>
  <li>
<em>Output</em>: A set of double curly braces containing an expression; when the template is rendered, it gets replaced with the value of that expression (e.g. <code class="highlighter-rouge">Hello </code>)</li>
  <li>
<em>Tag</em>: A set of matching curly braces and percent signs, used for the logic in your template (e.g. ``)</li>
</ul>

<p>Jekyll has an extensive theme system, which we can leverage to build good-looking websites effortlessly. My personal favorite Github-hosted theme is <a href="https://github.com/YoussefRaafatNasry/portfolYOU"><code class="highlighter-rouge">PortfolYOU</code></a>, which is the one I am using right now on the website you’re on.</p>

<p>Jekyll sites can also be enriched by plugins. You can browse for some good ones <a href="https://github.com/planetjekyll/awesome-jekyll-plugins">here</a>. My personal favorites are the following ones:</p>

<ul>
  <li>
<a href="https://github.com/jekyll/jemoji"><code class="highlighter-rouge">jemoji</code></a>: GitHub-flavored emoji plugin for Jekyll</li>
  <li>
<a href="https://github.com/benbalter/jekyll-remote-theme"><code class="highlighter-rouge">jekyll-remote-theme</code></a>: Jekyll plugin for building Jekyll sites with any GitHub-hosted theme</li>
  <li>
<a href="https://github.com/jekyll/jekyll-admin"><code class="highlighter-rouge">jekyll-admin</code></a>: A Jekyll plugin that provides users with a traditional CMS-style graphical interface to author content and administer Jekyll sites</li>
  <li>
<a href="https://github.com/jekyll/jekyll-sitemap"><code class="highlighter-rouge">jekyll-sitemap</code></a>: Jekyll plugin to silently generate a sitemaps.org compliant sitemap for your Jekyll site</li>
  <li>
<a href="https://github.com/hendrikschneider/jekyll-analytics"><code class="highlighter-rouge">jekyll-analytics</code></a>: Plugin to easily add webanalytics to your jekyll site. Currently Google Analytics, Piwik and mPulse are supported.</li>
</ul>

<p>If you want to create a local Jekyll project you can open a command-line window and do the following:</p>

<ol>
  <li>Make sure you have <code class="highlighter-rouge">Ruby</code> installed on your system</li>
  <li>Run <code class="highlighter-rouge">gem install bundler jekyll</code>
</li>
  <li>Run <code class="highlighter-rouge">jekyll new my-site &amp;&amp; cd my-site</code>
</li>
  <li>Run <code class="highlighter-rouge">bundle exec jekyll serve</code>
</li>
</ol>

<p>This will run your <code class="highlighter-rouge">my-site</code> locally at <code class="highlighter-rouge">http://localhost:4000</code>, so that you can open a browser and see what’s happening.</p>

<p>That’s pretty much all you have to know to work with Jekyll. Next up, we have to host our website on a specific provider to make it accessible on the internet, and here is where <strong>Github pages</strong> comes in handy.</p>

<h3 id="what-is-github-pages">What is Github pages?</h3>

<p><a href="https://pages.github.com/">Github pages</a> is a free hosting service provided by the Github organization. With it, you can create one personal website with just a few clicks, which will be live at the URL <code class="highlighter-rouge">&lt;username&gt;.github.io</code>. To start, you have to do the following:</p>

<ol>
  <li>Create a public repository and name it <code class="highlighter-rouge">&lt;username&gt;.github.io</code>, where <code class="highlighter-rouge">&lt;username&gt;</code> is your lowercase Github username (e.g. my Github username is <strong>Wadaboa</strong> and my Github pages repo is named <code class="highlighter-rouge">wadaboa.github.io</code>)</li>
  <li>Head over to the new repo settings and flag “Enforce HTTPS” if it is unflagged. Then, optionally write a custom domain, other than <code class="highlighter-rouge">&lt;username&gt;.github.io</code>, inside the “Custom domain” field (note that this will require to modify some <a href="https://help.github.com/en/github/working-with-github-pages/managing-a-custom-domain-for-your-github-pages-site">DNS settings</a> on your custom domain provider)</li>
</ol>

<p>You are good to go. Now, all you have to do is download a Jekyll theme, or build a Jekyll website from scratch, as described above, and upload those files to the <code class="highlighter-rouge">master</code> branch of your Github pages repo.</p>

<p>So, why is <strong>Travis CI</strong> needed if the entire deployment is already done by Github pages? We shall see where a <em>Continuos Integration</em> pipeline turns out useful in the next section.</p>

<h3 id="what-is-travis-ci">What is Travis CI?</h3>

<p><a href="https://travis-ci.org/">Travis CI</a> is a tool used to automate some repetitive programming tasks, which fall under the category known as <em>DevOps</em>.</p>

<p>In our example, how could Travis CI help us? Well, if you are using a Jekyll Github-hosted remote theme and you want to extend it with new functionalities, such as new plugins, you may want to locally build your Jekyll project and then directly push the generated static files to Github pages, in order to let it serve those files without the need to perform build operations. This operation is actually needed when you want to work with non-safe plugins, i.e. plugins which are not supported by the build process of Github pages. Examples of such plugin are <code class="highlighter-rouge">jekyll-analytics</code> and <code class="highlighter-rouge">jekyll-sitemap</code>.</p>

<p>In order to work with Travis CI, we need to follow some simple steps:</p>

<ul>
  <li>Head over to the <a href="https://travis-ci.org/">Travis CI website</a> and sign-in using Github</li>
  <li>Click on your profile picture in the top right of your Travis Dashboard, click Settings and then the green Activate button, and select the repositories you want to use with Travis CI (in this example we have to select our <code class="highlighter-rouge">&lt;username&gt;.github.io</code>)</li>
  <li>On Github, click on your profile picture in the top right → Settings → Developer settings → Personal access tokens → Generate new token, then add a <em>Travis CI</em> entry with the <code class="highlighter-rouge">repo</code> scopes and copy the corresponding token</li>
  <li>Click on Dashboard → <code class="highlighter-rouge">&lt;username&gt;.github.io</code> under Active repositories → More options → Settings → Environment Variables and set the variable <code class="highlighter-rouge">GITHUB_API_KEY</code> with value the Github generated token</li>
</ul>

<p>Now, you need to create a <code class="highlighter-rouge">.travis.yml</code> file in the root of your <code class="highlighter-rouge">&lt;username&gt;.github.io</code> repository, with the following content:</p>

<div class="language-yml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">language</span><span class="pi">:</span> <span class="s">ruby</span>
<span class="na">rvm</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">2.6.3</span>

<span class="na">before_install</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">gem install bundler</span>

<span class="na">install</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">bundle install</span>

<span class="na">before_script</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">chmod +x ./scripts/build</span>

<span class="na">script</span><span class="pi">:</span> <span class="s">./scripts/build</span>

<span class="na">branches</span><span class="pi">:</span>
  <span class="na">only</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">release</span>

<span class="na">sudo</span><span class="pi">:</span> <span class="s">required</span>

<span class="na">cache</span><span class="pi">:</span> <span class="s">bundler</span>

<span class="na">deploy</span><span class="pi">:</span>
  <span class="na">provider</span><span class="pi">:</span> <span class="s">pages</span>
  <span class="na">skip_cleanup</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">keep-history</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">local_dir</span><span class="pi">:</span> <span class="s">_site/</span>
  <span class="na">target_branch</span><span class="pi">:</span> <span class="s">master</span>
  <span class="na">github_token</span><span class="pi">:</span> <span class="s">$GITHUB_API_KEY</span>
  <span class="na">on</span><span class="pi">:</span>
    <span class="na">branch</span><span class="pi">:</span> <span class="s">release</span>

<span class="na">notifications</span><span class="pi">:</span>
  <span class="na">email</span><span class="pi">:</span>
    <span class="na">on_success</span><span class="pi">:</span> <span class="s">never</span>
    <span class="na">on_failure</span><span class="pi">:</span> <span class="s">always</span>
</code></pre></div></div>

<p>You will also need to create a <code class="highlighter-rouge">build</code> script inside a new <code class="highlighter-rouge">scripts</code> folder, with the following content:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/env bash</span>

<span class="nb">set</span> <span class="nt">-e</span>
<span class="nv">JEKYLL_ENV</span><span class="o">=</span>production bundle <span class="nb">exec </span>jekyll build <span class="nt">--destination</span> _site
<span class="nb">touch</span> ./_site/.nojekyll

</code></pre></div></div>

<p>In order to make everything work, you will also need to create two new branches:</p>

<ul>
  <li>
<code class="highlighter-rouge">develop</code>, which will contain works-in-progress, not ready to be published</li>
  <li>
<code class="highlighter-rouge">release</code>, which will contain the latest published website</li>
</ul>

<p>When you will perform a push on the <code class="highlighter-rouge">release</code> branch, Travis CI will be triggered and your build will start. If anything goes wrong, you will receive a notification on your Github-associated email, otherwise you will see a push on the <code class="highlighter-rouge">master</code> branch, made by <code class="highlighter-rouge">traviscibot</code>, and your updated website will be live.</p>

<p>Remember that the <code class="highlighter-rouge">master</code> branch is where Travis CI will copy the static files associated with your Jekyll website. These static files are generated inside the <code class="highlighter-rouge">_site</code> folder in the root of your project when you perform a <code class="highlighter-rouge">bundle exec jekyll build</code> operation and they should not be present in your <code class="highlighter-rouge">release</code> branch, hence you should always add <code class="highlighter-rouge">_site/</code> to your <code class="highlighter-rouge">.gitignore</code> file.</p>


</div>
  </main>

  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <i class="fas fa-code"></i> with <i class="fas fa-heart"></i>
    by <strong>Alessio Falai</strong>
  </small>

  <div class="container-fluid justify-content-center">
<a class="social mx-1" href="mailto:falai.alessio@gmail.com" style="color: #6c757d" onmouseover="this.style.color='#db4437'" onmouseout="this.style.color='#6c757d'">
      <i class="fas fa-envelope fa-1x"></i>
    </a><a class="social mx-1" href="https://www.facebook.com/wadaboa" style="color: #6c757d" onmouseover="this.style.color='#3b5998'" onmouseout="this.style.color='#6c757d'">
      <i class="fab fa-facebook fa-1x"></i>
    </a><a class="social mx-1" href="https://www.github.com/Wadaboa" style="color: #6c757d" onmouseover="this.style.color='#333333'" onmouseout="this.style.color='#6c757d'">
      <i class="fab fa-github fa-1x"></i>
    </a><a class="social mx-1" href="https://www.instagram.com/Wadaboa" style="color: #6c757d" onmouseover="this.style.color='#405de6'" onmouseout="this.style.color='#6c757d'">
      <i class="fab fa-instagram fa-1x"></i>
    </a><a class="social mx-1" href="https://www.linkedin.com/in/alessio-falai" style="color: #6c757d" onmouseover="this.style.color='#007bb5'" onmouseout="this.style.color='#6c757d'">
      <i class="fab fa-linkedin-in fa-1x"></i>
    </a>

</div>
<small id="attribution">
    theme <a href="https://github.com/YoussefRaafatNasry/portfolYOU">portfolYOU</a>
  </small>
  
</footer>
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>

</body>

</html>